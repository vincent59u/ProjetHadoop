<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>E-commerce Brésilien</title>

    <!-- Bootstrap core CSS -->
    <link href="../../web/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <!-- Custom styles for this template -->
    <link href="../../web/css/style.css" rel="stylesheet">
</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
    <div class="container">
        <a class="navbar-brand" href="index.html">E-commerce Brésilien</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarResponsive">
            <ul class="navbar-nav ml-auto">
                <li class="nav-item active">
                    <a class="nav-link" href="index.html">Accueil</a>
                </li>
            </ul>
        </div>
    </div>
</nav>

<!-- Page Content -->
<div class="container">
    <div class="row">
        <div class="col-lg-3">
            <h2 class="my-4">Questions</h2>
            <div class="list-group">
                <a href="question1.html" class="list-group-item">Question 1</a>
                <a href="question2.html" class="list-group-item active">Question 2</a>
                <a href="question3.html" class="list-group-item">Question 3</a>
                <a href="question4.html" class="list-group-item">Question 4</a>
                <a href="question5.html" class="list-group-item">Question 5</a>
            </div>
        </div>
        <div class="col-lg-9">
            <div class="card card-outline-secondary mt-4">
                <div class="card-header">
                    <h3 class="card-title">Question 2</h3>
                    <h4>Moyenne des frais de ports en fonction de la distance de livraison</h4>
                </div>
                <div class="card-body">
                    <p class="card-text">
                    Cette question permet de connaitre l'évolution des frais de ports pratiqués par l'ensemble des vendeurs
                    en fonction de la distance les séparants de leurs clients.<br>

                    <h3>Fichiers et attributs utilisés</h3>
                    <table class="table table-bordered table-striped">
                        <tr>
                            <th>Fichiers</th>
                            <th>Attributs</th>
                        </tr>
                        <tr>
                            <td>olist_customers_dataset.csv</td>
                            <td>customer_zip_code_prefix, customer_id</td>
                        </tr>
                        <tr>
                            <td>olist_sellers_dataset.csv</td>
                            <td>seller_zip_code_prefix, seller_id</td>
                        </tr>
                        <tr>
                            <td>olist_geolocation_dataset.csv</td>
                            <td>geolocation_zip_code_prefix, geolocation_lat, geolocation_lng</td>
                        </tr>
                        <tr>
                            <td>olist_orders_dataset.csv</td>
                            <td>order_id, customer_id</td>
                        </tr>
                        <tr>
                            <td>customersGeolocation-r-00000<sup>*</sup></td>
                            <td>customer_id, latitude, longitude</td>
                        </tr>
                        <tr>
                            <td>olist_order_items_dataset.csv</td>
                            <td>order_id, freight_value</td>
                        </tr>
                        <tr>
                            <td>sellersGeolocation-r-00000<sup>*</sup></td>
                            <td>seller_id, latitude, longitude</td>
                        </tr>
                        <tr>
                            <td>customer_order_location-r-00000<sup>*</sup></td>
                            <td>order_id, latitude, longitude</td>
                        </tr>
                        <tr>
                            <td>seller_order_location-r-00000<sup>*</sup></td>
                            <td>order_id, latitude, longitude, freight_value</td>
                        </tr>
                    </table>
                    <small><sup>*</sup> Fichiers générés par un Job Hadoop auparavant</small>

                    <h3>Mapper</h3>
                    Cette question nécessite plusieurs phases de map reduce.<br>
                    La première phase de mapping associe le zip_code_prefix avec les attributs customer_id, seller_id, geolocation_lat etgeolocation_lng issus des trois premiers fichiers du tableau ci-dessus.<br>
                    La seconde phase de mapping associe order_id aux informations de géolocalisation des vendeurs et clients. Cette opération est réalisée
                    à partir des fichiers customersGeolocation-r-00000, olist_orders_dataset.csv, sellersGeolocation-r-00000, olist_order_items_dataset.csv<br>
                    Enfin, un dernier mapper associe pour chaque commande les informations de géolocalisation des clients et vendeurs ainsi que le montant des frais de ports. Ce mapper s'effectue sur les deux derniers fichiers du tableau précédent.<br><br>

                    <h3>Redcucer</h3>
                    Comme cette question nécessite trois mappers différents, il y a donc trois reducers.<br>
                    Le premier génère deux fichiers qui sont customersGeolocation-r-00000 et sellersGeolocation-r-00000 qui contiennent le customer_id ou seller_id avec la latitude et longitude.<br>
                    Le second permet de regrouper dans deux fichiers (un pour le client et un pour le vendeur) l'order_id avec les informations de géolocalisation et le montant des frais de port pour le fichier concernant le vendeur.<br>
                    Pour finir, le dernier reducer calcul la distance entre le client et le vendeur en fonction des coordonnées géographiques. cette distance est ensuite
                    regroupée par tranche a laquelle on associe la moyenne des montant des frais de port.<br><br>

                    <h3>Analyse économique</h3>
                    On remarque que les frais de ports augmentent en fonction de la distance de livraison. Nous pouvons alors nous
                    poser la question d'installer plusieurs entrepôts pour couvrir la superficie du pays. Il est également intéressant de
                    coupler cette question avec question 3.<br><br>

                    <h3>Graphique</h3>
                    <canvas id="question2"></canvas>
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Footer -->
<br><br>
<footer class="py-5 bg-dark">
    <div class="container">
        <p class="m-0 text-center text-white">Copyright &copy; Matthieu VINCENT 2018</p>
    </div>
</footer>

<!-- Bootstrap core JavaScript -->
<script src="../../web/vendor/jquery/jquery.min.js"></script>
<script src="../../web/vendor/chartjs/chartjs.min.js"></script>
<script src="../../web/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

<!-- Chart -->
<script src="../js/question2.js"></script>
</body>
</html>